{% extends 'base.html' %}

{% block content %}
<div class="content-detail-container">
    <!-- Hero-—Å–µ–∫—Ü–∏—è —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∏ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π -->
    <div class="content-hero" style="background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('{{ content.image.url }}') center/cover;">
        <div class="container">
            <div class="row">
                <div class="col-lg-4">
                    <div class="content-poster">
                        <img src="{{ content.image.url }}" alt="{{ content.title }}" class="img-fluid rounded shadow">
                    </div>
                </div>
                <div class="col-lg-8">
                    <div class="content-meta">
                        <h1 class="content-title">{{ content.title }}</h1>

                        <div class="content-actions">
                            {% if user.is_authenticated %}
                            <form method="post" action="{% url 'content-like' content.id %}" class="like-form">
                                {% csrf_token %}
                                <button type="submit" class="btn-like">
                                    {% if content.id in liked_contents %}
                                    <span class="liked">‚ù§Ô∏è –í –∏–∑–±—Ä–∞–Ω–Ω–æ–º</span>
                                    {% else %}
                                    <span>ü§ç –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
                                    {% endif %}
                                </button>
                            </form>
                            {% endif %}
                        </div>

                        <div class="content-rating">
                            <div class="rating-value">
                                <span class="score">{{ content.evaluation }}</span>
                                <span class="max-score">/10</span>
                            </div>
                            <div class="rating-stars" data-rating="{{ content.evaluation|default:0 }}">
                                {% for i in "12345" %}
                                    <span class="star">
                                        <span class="star-background">‚òÖ</span>
                                        <span class="star-foreground">‚òÖ</span>
                                    </span>
                                {% endfor %}
                            </div>

                            <script>
                            document.addEventListener('DOMContentLoaded', function() {
                                const ratingElements = document.querySelectorAll('.rating-stars');

                                ratingElements.forEach(element => {
                                    const rating = parseFloat(element.dataset.rating) / 2; // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º 10-–±–∞–ª–ª—å–Ω—É—é –≤ 5-–±–∞–ª–ª—å–Ω—É—é
                                    const stars = element.querySelectorAll('.star');

                                    stars.forEach((star, index) => {
                                        const starNum = index + 1;
                                        const foreground = star.querySelector('.star-foreground');

                                        if (rating >= starNum) {
                                            foreground.style.width = '100%';
                                        } else if (rating > starNum - 1) {
                                            const fillPercent = (rating - (starNum - 1)) * 100;
                                            foreground.style.width = `${fillPercent}%`;
                                        } else {
                                            foreground.style.width = '0%';
                                        }
                                    });
                                });
                            });
                            </script>
                        </div>

                        <div class="content-type-badge">
                            <span class="badge">{{ content.type_content.title_type }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="container content-main">
        <div class="row">
            <div class="col-lg-8">
                <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
                <section class="content-section">
                    <h2 class="section-title">–û–± —ç—Ç–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç–µ</h2>
                    <div class="content-description">
                        <p>{{ content.summery }}</p>
                    </div>
                </section>

                <!-- –°–æ–∑–¥–∞—Ç–µ–ª–∏ -->
                <section class="content-section">
                    <h2 class="section-title">–°–æ–∑–¥–∞—Ç–µ–ª–∏</h2>
                    <div class="creators-grid">
                        {% for creator in content.creator.all %}
                        <div class="creator-card">
                            <div class="creator-name">{{ creator.name }}</div>
                        </div>
                        {% endfor %}
                    </div>
                </section>
            </div>

            <div class="col-lg-4">
                <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π -->
                <div class="content-sidebar">
                    <!-- –ü—Ä–∏—á–∏–Ω—ã –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å -->
                    {% if content.reasons_to_buy.all %}
                    <section class="sidebar-section">
                        <h3 class="sidebar-title">–ü–æ—á–µ–º—É —Å—Ç–æ–∏—Ç –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å</h3>
                        <ul class="reasons-list">
                            {% for reason in content.reasons_to_buy.all %}
                            <li class="reason-item">
                                <span class="reason-icon">‚úì</span>
                                <span class="reason-text">{{ reason }}</span>
                            </li>
                            {% endfor %}
                        </ul>
                    </section>
                    {% endif %}

                    <!-- –î–µ—Ç–∞–ª–∏ -->
                    <section class="sidebar-section">
                        <h3 class="sidebar-title">–î–µ—Ç–∞–ª–∏</h3>
                        <div class="details-list">
                            <div class="detail-item">
                                <span class="detail-label">–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞ —Å–∞–π—Ç:</span>
                                <span class="detail-value">{{ content.created_at|date:"d.m.Y" }}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">–¢–∏–ø:</span>
                                <span class="detail-value">{{ content.type_content.title_type }}</span>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}